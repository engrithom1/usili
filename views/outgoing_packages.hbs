<style>
    .loading-hiden {
        display: none;
    }

    .loading-show {
        display: contents;
    }

    .no-href-dec {
        text-decoration: none;
        cursor: pointer;
    }
    .pdf-item{
        border: 1px solid #555;
        border-radius: 8px;
        padding: 15px 10px;
        margin-bottom: 20px;
    }
    .pdf-table {
  width: 100%;
}
.td-1 {
  width: 40%;
  padding-left:8px;
}
.td-2 {
  width: 30%;
  padding-left:8px;
}
</style>

<div class="content-wrapper">
    <div class="row mb-3">
        <div class="col-md-12">
            <div class="row">
                <div class="col-12 col-xl-8 mb-4 mb-xl-0">
                    <h3 class="font-weight-bold">Outgoing Packages</h3>
                </div>
                <div class="col-12 col-xl-4">

                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between table-responsive">
                <p class="card-title"></p>
                <div class="d-flex">
                    <select class="form-select form-control simple-select" name="branch_select" id="branch_select">
                        {{#if branches}}
                        <option selected="true" value="0">All Destinations</option>
                        {{/if}}
                        {{#each branches}}
                        <option value="{{this.id}}">{{this.name}}</option>
                        {{/each}}

                    </select>
                    <!--select class="form-select form-control simple-select" name="tag_select" id="tag_select">
                        {{#each tags}}
                        <option value="{{this.id}}">{{substr 14 this.name}}</option>
                        {{/each}}
                        <option selected="true" value="0">All Package Type</option>
                       
                    </select-->
                    <select class="form-select form-control simple-select" name="staff_select" id="staff_select">
                        {{#each staffs}}
                        <option value="{{this.id}}">{{substr 14 this.fulname}}</option>
                        {{/each}}
                        {{#if staffs}}
                        <option selected="true" value="0">All Staffs(Agent)</option>
                        {{/if}}
                    </select>
                    <button id="filter_btn" class="btn btn-primary simple-btn">Filter</button>
                    <button id="pdf_btn" class="btn btn-success text-white simple-btn">PDF</button>
                    <button id="sms_btn" class="btn btn-dark text-white simple-btn">Send SMS</button>
                </div>
            </div>

            <div id="message_phone" class="loading-hiden">
<div class="card mt-3">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-7 col-sm-12">
                            <div class="form-group">
                                <label for="">Phone numbers (comma separated)</label>
                                <textarea class="form-control" rows="5" name="phone_list" id="phone_list"></textarea>
                            </div>
                        </div>
                        <div class="col-md-5 col-sm-12">
                            <div class="form-group">
                                <label for="">Message</label>
                                <textarea class="form-control" name="message_field" id="message_field"></textarea>
                            </div>
                            <div id="loading-send-sms" class="loading-hiden">
                    <img class="center-block" width="350" src="/images/cupertino.gif" alt="#" />
                </div>
                            <div class="d-flex justify-content-between">
                                <button class="btn btn-primary" id="send_sms">Send SMS</button>
                                <button class="btn btn-danger text-white" id="clear_chat">Clear Chat</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>

            <div class="table-responsive">
                <div id="loading" class="loading-hiden">
                    <img class="center-block" width="350" src="/images/cupertino.gif" alt="#" />
                </div>
                <table class="table table-striped mt-3">
                    <thead>
                        <tr class="thead-style">
                            <th>No</th>
                            <th>Package name</th>
                            <th>Price</th>
                            <th>Package Type</th>
                            <th>Receiver name </th>
                            <th>Receiver phone </th>
                            <th>Destination </th>
                            <th>Sender staff </th>
                            <th>Date issue </th>
                            <th>Action </th>
                        </tr>
                    </thead>
                    <tbody id="outgoing-list">

                        {{#each packages}}
                        <tr id="package_{{this.id}}">
                            <td>{{index_plas @index 1}}</td>
                            {{#if (if_equal this.package_size 'Small' )}}
                            <td><span class="text-success text-small">[sm] </span><span
                                    class="text-capitalize">{{this.name}}</span></td>
                            {{/if}}
                            {{#if (if_equal this.package_size 'Large' )}}
                            <td><span class="text-danger">[lg] </span><span class="text-capitalize">{{this.name}}</span>
                            </td>
                            {{/if}}
                            {{#if (if_equal this.package_size 'Medium' )}}
                            <td><span class="text-primary">[md] </span><span
                                    class="text-capitalize">{{this.name}}</span></td>
                            {{/if}}
                            <td>{{this.price}}</td>
                            <td><label class="badge badge-dark">{{this.package_tag}}</label></td>
                            <td class="text-capitalize"> {{this.receiver_name}} </td>
                            <td> <a class="text-success no-href-dec add_phone"
                                    phone="{{this.receiver_phone}}">{{this.receiver_phone}} <i
                                        class="mdi mdi-message-processing"></i></a></td>
                            <td><label class="badge badge-primary">{{this.bname}}</label></td>
                            <td> <label class="badge badge-success">{{fulname}}</label></td>

                            <td> {{subdate this.created_at}}</td>
                            <td>
                                <button type="button" pid="{{this.id}}" bid="{{this.bid}}" pname="{{this.name}}"
                                    pbranch="{{this.bname}}" pimage="{{this.thumbnail}}" branch-id="{{this.id}}"
                                    class="btn receipt_btn btn-primary btn-icon">
                                    <i class="fa fa-print"></i>
                                </button>
                                <button type="button" pid="{{this.id}}" bid="{{this.bid}}" pname="{{this.name}}"
                                    pbranch="{{this.bname}}" pimage="{{this.thumbnail}}" branch-id="{{this.id}}"
                                    class="btn edit_btn btn-success btn-icon">
                                    <i class="fa fa-edit"></i>
                                </button>

                                <button type="button" pname="{{this.name}}" pbranch="{{this.bname}}"
                                    pimage="{{this.thumbnail}}" pid="{{this.id}}" bid="{{this.bid}}"
                                    class="remove_btn btn btn-danger btn-icon">
                                    <i class="fa fa-times"></i>
                                </button>
                            </td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!--div class="row">
        {{#each packages}}
        <div id="package_{{this.id}}" class="col-sm-6 col-md-4 grid-margin stretch-card">
            <div class="card tale-bg">
                <div class="card-people mt-auto">
                    <img class="package-branch-img" src="/images/{{this.thumbnail}}" alt="{{this.name}}">
                    <div class="weather-info">
                        <div class="d-flex">
                            <div class="ms-2">
                                <h3 class="location font-weight-normal">{{this.name}}</h3>
                                <h4 class="font-weight-normal">To : {{this.bname}}</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="m-2">
                    <!--button type="button" class="btn-pck-action btn btn-primary">
                        Receive
                    </button-->
    <!--button type="button" pid="{{this.id}}" bid="{{this.bid}}" pname="{{this.name}}"
                        pbranch="{{this.bname}}" pimage="{{this.thumbnail}}" branch-id="{{this.id}}"
                        class="btn-pck-action edit_btn btn btn-success">
                        Edit info
                    </button>
                    <button type="button" pname="{{this.name}}" pbranch="{{this.bname}}" pimage="{{this.thumbnail}}"
                        pid="{{this.id}}" bid="{{this.bid}}" class="btn-pck-action remove_btn btn btn-danger">
                        Remove
                    </button>
                </div>
            </div>
        </div>
        {{/each}}
    </div-->
    <input type="hidden" name="action-type" id="action-type">
</div>

<!-- remove modal-->
<div class="modal fade mobile-full-width" id="removeModal" tabindex="-1" data-bs-backdrop="static"
    data-bs-keyboard="false" role="dialog" aria-labelledby="removeModal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">

        <div class="modal-content">
            <div class="modal-header">
                <h4 class="font-weight-bold">Remove Package</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                </button>
            </div>
            <div class="container mt-3 mb-3">
                <div class="row">
                    <div class="col-sm-6 col-md-4 grid-margin stretch-card">
                        <div class="card tale-bg">
                            <div class="card-people mt-auto">
                                <img class="package-branch-img" id="remove-img" src="" alt="{{this.name}}">
                                <div class="weather-info">
                                    <div class="d-flex">
                                        <div class="ms-2">
                                            <h3 id="remove-pname" class="location font-weight-normal"></h3>
                                            <h4 id="remove-bname" class="font-weight-normal"></h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-4">
                        <input type="hidden" name="barcode_id" id="code-text">
                        <div id="reading-bar" class="scanner-area">
                            <div class="pt-3 pb-3">
                                <img id="codebar-img"
                                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARIAAAB6CAYAAABz59ygAAAABmJLR0QA/wD/AP+gvaeTAAANc0lEQVR4nO3ce2xTZR8H8G/brd1kY4z7AIFtyDaQMhAwwBjJuIgmAgFJ5OIgG1TZgBkkoi5gjAETxkVRJyGgSCQqGFAZlxjk2gWGCYRbhIiTaRAGFIRt3Nbxff94s76UtlvhwfCSfD9J/+B3fuc5zzmkX855TtVCkhARMWB91BMQkcefgkREjClIRMSYgkREjClIRMSYgkREjClIRMSYgkREjClIRMRYRLiNFovF78/1P4itr9/7A9nG6qHGud/6/R73/22ej2r8hzWfh3U9H1b/o/p7/7fn829f53DroeiORESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMWUjyUU9CRB5vuiMREWMKEhExpiAREWMKEhExpiAREWMKEhExpiAREWMKkgd04cIFzJ07F5mZmWjXrh2ioqKQlJSEkSNHYufOnUH38Xq9WLp0Kfr164eWLVsiLi4OTqcTCxcuxLVr1/x6Z8+eDYvF0uBn2rRpvv558+Y12j9hwgS/Y/Ts2TNkb0FBQcD86+rq8NFHH6Fnz56Ijo5GTEwMnn32Waxduxbh/Bxp3759sNlssFgsWL16dcD2pUuXYtSoUUhMTER0dDTatm2LjIwMFBcXw+v1Bh3z/PnzyM3NRUJCAhwOB1JTU7FkyRLU1dUF9LrdbuTl5cHpdCI2NhZt2rTBoEGDUFxcHLRfwhfxqCfwuCovL8eiRYuQnJyMHj16IC4uDufPn8eWLVtQUlKC4uJivPbaa377TJo0Cd9++y2SkpIwceJEWK1W/PzzzygsLMT69etx4MABREVFAQD69++PmpqaoMfeuXMnTp8+jaysLF+tT58+cLlcQfv37t2LkydP+vXXs1qtmDp1akB9wIABAbWcnBysXbsW7dq1wyuvvAKLxYKSkhJMnjwZv//+O957772Q1+v69evIyclBZGQkbt26FbRnwYIFsNlsSEtLwzPPPIMbN27A7XYjPz8fP/30EzZt2gSLxeLr93g8GDhwIMrLyzF8+HCkpaVh27ZtmDNnDo4fP44vvvjC13v79m0MGjQIAJCcnIzMzEzU1tbC7XbD7XZj+/bt+P7772G16t/WB0J5IFevXuXZs2cD6mVlZXQ4HIyJiWFNTY2vfuTIEQJgYmIiq6urffXa2lr26dOHALh+/fpGj3vr1i22adOGLVq04M2bNxvt93q97NSpE2NjY1lVVeW3zel00m63NzoGSR48eJAA2L59e3o8Hl/d4/EwKSmJERERPH36dMj9Z82axc6dO3PKlCkEwFWrVgX0nDx5knfu3PGrXb58mU8//TQBcNu2bX7bCgoKCICzZ8/21aqrq339u3fv9tVv377N3NxcHj161G+M8vJytm3blgD4zTffhHUtJJDi9wE1bdoU7dq1C6j369cP3bp1Q3V1NcrLy331iooKAEDfvn3RpEkTXz0iIgKZmZkAgEuXLjV63I0bN6KyshLZ2dlwOByN9m/duhUVFRUYP348YmJiGu0PZceOHQCA7OxsNG/e3Fdv3rw5ZsyYAa/Xi/Xr1wfdd8+ePfjkk09QXFzsd+73SklJ8bvjAID4+HiMHDkSAHDs2DFf3ev14quvvoLFYsEbb7zhqzdp0gR5eXkA4HdHEhkZiVWrVqFHjx5+4ycmJiI3NxfAfx+95MHo0eYhO3LkCH799VdERUWhY8eOvnpaWhqsVisOHjyI6upq35fa6/Viz549iIyMDProca8VK1YAQNDHkYb6715PududO3ewcOFClJeXw+FwoH///hg7diyio6P9+i5fvgwAQcOzc+fOAICDBw8GbKupqUFubi7GjRuH559/Hlu2bAlr3vWqqqqwdetWAMBTTz3lq586dQoejwdOpzNgTiNGjAAAlJaWhnWM+nCLjY29r7nJ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"
                                    alt="" srcset="">
                            </div>

                            <div class="d-flex">
                                <input class="form-control" type="hidden" name="" id="input-pid">
                                <!--input class="form-control" type="text" name="" id="input-code">
                                <button type="button" id="search-bar" class="btn btn-primary">search</button-->
                            </div>

                        </div>
                        <div id="barcode-msg"></div>

                        <div id="loading-bar" class="loading-hiden">
                            <img class="center-block" width="80%" src="/images/bar_gif.gif" alt="#" />
                        </div>

                    </div>

                    <div class="col-sm-6 col-md-4">
                        <div class="form-group">
                            <label class="form-label">Reason*</label>
                            <textarea name="description" maxlength="400" id="description"
                                class="form-control text-area-style" rows="5" style="width: 100% !important;"
                                placeholder="give reason to remove the package"></textarea>
                        </div>
                        <div id="loading" class="loading-hiden">
                            <img class="center-block" width="300" src="/images/cupertino.gif" alt="#" />
                        </div>
                        <button type="button" id="remove-package" class="btn btn-primary w-100 mt-3">Remove
                            Package</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade mobile-full-width" id="editModal" tabindex="-1" data-bs-backdrop="static"
    data-bs-keyboard="false" role="dialog" aria-labelledby="editModal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">

        <div class="modal-content">
            <div class="modal-header">
                <h4 class="font-weight-bold">Edit Package</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                </button>
            </div>
            <div class="container mt-3 mb-3">
                <div class="row">
                    <div class="col-sm-6 col-md-4 grid-margin stretch-card">
                        <div class="card tale-bg">
                            <div class="card-people mt-auto">
                                <img class="package-branch-img" id="edit-img" src="" alt="{{this.name}}">
                                <div class="weather-info">
                                    <div class="d-flex">
                                        <div class="ms-2">
                                            <h3 id="edit-pname" class="location font-weight-normal"></h3>
                                            <h4 id="edit-bname" class="font-weight-normal"></h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-4">
                        <input type="hidden" name="barcode_id" id="code-text-edit">
                        <div id="reading-bar-edit" class="scanner-area">
                            <div class="pt-3 pb-3">
                                <img id="codebar-img-edit"
                                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARIAAAB6CAYAAABz59ygAAAABmJLR0QA/wD/AP+gvaeTAAANc0lEQVR4nO3ce2xTZR8H8G/brd1kY4z7AIFtyDaQMhAwwBjJuIgmAgFJ5OIgG1TZgBkkoi5gjAETxkVRJyGgSCQqGFAZlxjk2gWGCYRbhIiTaRAGFIRt3Nbxff94s76UtlvhwfCSfD9J/+B3fuc5zzmkX855TtVCkhARMWB91BMQkcefgkREjClIRMSYgkREjClIRMSYgkREjClIRMSYgkREjClIRMRYRLiNFovF78/1P4itr9/7A9nG6qHGud/6/R73/22ej2r8hzWfh3U9H1b/o/p7/7fn829f53DroeiORESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMKUhExJiCRESMWUjyUU9CRB5vuiMREWMKEhExpiAREWMKEhExpiAREWMKEhExpiAREWMKkgd04cIFzJ07F5mZmWjXrh2ioqKQlJSEkSNHYufOnUH38Xq9WLp0Kfr164eWLVsiLi4OTqcTCxcuxLVr1/x6Z8+eDYvF0uBn2rRpvv558+Y12j9hwgS/Y/Ts2TNkb0FBQcD86+rq8NFHH6Fnz56Ijo5GTEwMnn32Waxduxbh/Bxp3759sNlssFgsWL16dcD2pUuXYtSoUUhMTER0dDTatm2LjIwMFBcXw+v1Bh3z/PnzyM3NRUJCAhwOB1JTU7FkyRLU1dUF9LrdbuTl5cHpdCI2NhZt2rTBoEGDUFxcHLRfwhfxqCfwuCovL8eiRYuQnJyMHj16IC4uDufPn8eWLVtQUlKC4uJivPbaa377TJo0Cd9++y2SkpIwceJEWK1W/PzzzygsLMT69etx4MABREVFAQD69++PmpqaoMfeuXMnTp8+jaysLF+tT58+cLlcQfv37t2LkydP+vXXs1qtmDp1akB9wIABAbWcnBysXbsW7dq1wyuvvAKLxYKSkhJMnjwZv//+O957772Q1+v69evIyclBZGQkbt26FbRnwYIFsNlsSEtLwzPPPIMbN27A7XYjPz8fP/30EzZt2gSLxeLr93g8GDhwIMrLyzF8+HCkpaVh27ZtmDNnDo4fP44vvvjC13v79m0MGjQIAJCcnIzMzEzU1tbC7XbD7XZj+/bt+P7772G16t/WB0J5IFevXuXZs2cD6mVlZXQ4HIyJiWFNTY2vfuTIEQJgYmIiq6urffXa2lr26dOHALh+/fpGj3vr1i22adOGLVq04M2bNxvt93q97NSpE2NjY1lVVeW3zel00m63NzoGSR48eJAA2L59e3o8Hl/d4/EwKSmJERERPH36dMj9Z82axc6dO3PKlCkEwFWrVgX0nDx5knfu3PGrXb58mU8//TQBcNu2bX7bCgoKCICzZ8/21aqrq339u3fv9tVv377N3NxcHj161G+M8vJytm3blgD4zTffhHUtJJDi9wE1bdoU7dq1C6j369cP3bp1Q3V1NcrLy331iooKAEDfvn3RpEkTXz0iIgKZmZkAgEuXLjV63I0bN6KyshLZ2dlwOByN9m/duhUVFRUYP348YmJiGu0PZceOHQCA7OxsNG/e3Fdv3rw5ZsyYAa/Xi/Xr1wfdd8+ePfjkk09QXFzsd+73SklJ8bvjAID4+HiMHDkSAHDs2DFf3ev14quvvoLFYsEbb7zhqzdp0gR5eXkA4HdHEhkZiVWrVqFHjx5+4ycmJiI3NxfAfx+95MHo0eYhO3LkCH799VdERUWhY8eOvnpaWhqsVisOHjyI6upq35fa6/Viz549iIyMDProca8VK1YAQNDHkYb6715PududO3ewcOFClJeXw+FwoH///hg7diyio6P9+i5fvgwAQcOzc+fOAICDBw8GbKupqUFubi7GjRuH559/Hlu2bAlr3vWqqqqwdetWAMBTTz3lq586dQoejwdOpzNgTiNGjAAAlJaWhnWM+nCLjY29r7nJ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"
                                    alt="" srcset="">
                            </div>

                            <div class="d-flex">
                                <input class="form-control" type="hidden" name="" id="input-pid-edit">
                                <!--input class="form-control" type="text" name="" id="input-code-edit">
                                <button type="button" id="search-bar-edit" class="btn btn-primary">search</button-->
                            </div>

                        </div>
                        <div id="barcode-msg-edit"></div>

                        <div id="loading-bar-edit" class="loading-hiden">
                            <img class="center-block" width="80%" src="/images/bar_gif.gif" alt="#" />
                        </div>

                    </div>

                    <div class="col-sm-6 col-md-4">
                        <div class="form-group">
                            <label class="form-label">Reason to Edit*</label>
                            <textarea name="description-edit-reason" maxlength="400" id="description-edit-reason"
                                class="form-control text-area-style" rows="5" style="width: 100% !important;"
                                placeholder="give reason to remove the package"></textarea>
                        </div>
                        <!--div id="loading" class="loading-hiden">
                            <img class="center-block" width="300" src="/images/cupertino.gif" alt="#" />
                        </div>
                        <button type="button" id="remove-package" class="btn btn-primary w-100 mt-3">Remove
                            Package</button-->
                    </div>
                    <div id="package-form" class="loading-hiden">
                        <div class="container col-12">
                            <h3 class="mp-3 mb-2">Package Actors</h3>
                            <div class="row">
                                <div class="col-sm-6 col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Sender name *</label>
                                        <input name="sender_name" id="sender_name" class="form-control" maxlength="60"
                                            required type="text" placeholder="fullname">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Sender phone *</label>
                                        <input name="sender_phone" id="sender_phone" class="form-control" maxlength="40"
                                            required type="text" placeholder="0xxxxxxxxx">
                                    </div>
                                </div>

                                <div class="col-sm-6 col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Receiver name *</label>
                                        <input name="receiver_name" id="receiver_name" class="form-control"
                                            maxlength="60" required type="text" placeholder="fullname">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Receiver phone *</label>
                                        <input name="receiver_phone" id="receiver_phone" class="form-control"
                                            maxlength="40" required type="text" placeholder="0xxxxxxxxx">
                                    </div>
                                </div>

                                <div class="col-sm-6 col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Transporter name *</label>
                                        <input name="transporter_name" id="transporter_name" class="form-control"
                                            maxlength="60" required type="text" placeholder="fullname">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Transporter phone *</label>
                                        <input name="transporter_phone" id="transporter_phone" class="form-control"
                                            maxlength="40" required type="text" placeholder="0xxxxxxxxx">
                                    </div>
                                </div>


                            </div>

                            <h3 class="mp-3 mb-2">Package Details</h3>
                            <div class="row">
                                <div class="col-sm-6 col-md-4">
                                    <div class="form-group">
                                        <label class="form-label">Package name *</label>
                                        <input type="hidden" name="p_edit_id" id="p_edit_id">
                                        <input name="name" id="name" class="form-control" maxlength="60" required
                                            type="text" placeholder="item name">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Transportation Price *</label>
                                        <input name="price" id="price" class="form-control" maxlength="40" required
                                            type="text" placeholder="1000">
                                    </div>
                                </div>

                                <div class="col-sm-12 col-md-8">
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="">Branch *</label>
                                                <select id="branch_to" name="branch_to"
                                                    class="form-select form-control">

                                                    {{#each branches}}
                                                    <option value="{{this.id}}">{{this.name}}</option>
                                                    {{/each}}

                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-6">
                                            <div class="form-group">
                                                <label class="">Arival Date *</label>
                                                <input class="form-control" type="date" name="arive_at" id="arive_at">
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-12">
                                            <div class="form-group">
                                                <label class="form-label">Description*</label>
                                                <textarea name="description-edit" id="description-edit"
                                                    class="form-control" rows="1" style="width: 100% !important;"
                                                    placeholder="Any additional details…"></textarea>
                                            </div>
                                        </div>

                                        <div class="col-sm-12 col-md-6">
                                            <div id="loading-update" class="loading-hiden">
                                                <img class="center-block" width="300" src="/images/cupertino.gif"
                                                    alt="#" />
                                            </div>
                                            <button type="button" id="update-package"
                                                class="mt-2 btn btn-primary w-100">Update
                                                Package</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade mobile-full-width" id="pdfModal" tabindex="-1" data-bs-backdrop="static"
    data-bs-keyboard="false" role="dialog" aria-labelledby="pdfModal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">

        <div class="modal-content">
            <div class="modal-header">
                <h4 class="font-weight-bold">Print On Transit Package</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                </button>
            </div>
            <div class="container mt-3 mb-3">
                <div class="d-flex justify-content-between mb-3">
                    <p></p>
                    <div>
                        <button class="btn btn-primary" id="print_pdf"><i class="fa fa-print"></i> Print Pdf</button>
                        <!--button class="btn btn-danger text-white">Close</button-->
                    </div>
                </div>

                <div id="package_manfest">
                    <div id="loading" class="loading-show">
                        <img class="center-block" width="350" src="/images/cupertino.gif" alt="#" />
                    </div>
                </div>
</div>
</div>
</div>
</div>

<script>

    $('#outgoing-packages').attr('class', 'nav-item active');
    let code = "";
    let reading = false;
    function isNumeric(num) {
        return /^-?\d+$/.test(num)
    }

    function validateAmount(amount) {

        if (amount == '' || amount == null) {
            alert('Price is required')
            return false;
        } else {
            if (isNumeric(amount)) {
                if (amount > 999) {
                    return true
                } else {
                    alert('Price must be 1000 or more')
                    return false;
                }
            } else {
                alert('Price must be Integer value')
                return false;
            }
        }

    }

    function validatePhone(phone, label) {

        if (phone == '' || phone == null) {
            alert(label + ' Phone number is required')
            return false;
        } else {

            if (phone.length == "10") {
                var first = phone.slice(0, 1)
                var last = phone.slice(-9)

                if (first == '0' || first == 0) {
                    //alert(first+" - "+last);
                    if (isNumeric(last)) {
                        return true;
                    } else {
                        alert('Phonenumber must be Integer value')
                        return false;
                    }
                } else {
                    alert('Phonenumber must begin with 0')
                    return false;

                }

            } else {
                alert('Phone number must have 10 digits begin with 0')
                return false;

            }
        }

    }

    function validateNames(text, label) {

        if (text == '' || text == null) {
            alert(label + ' name is required')
            return false;
        } else {
            return true;
        }

    }

     function validateMessage(text, label) {

        if (text == '' || text == null) {
            alert(label + ' name is required')
            return false;
        } else {
            if(text.length > 360){
alert('Message is too long, Maximum characters is 360, You typed '+text.length+' character')
            }else{
               return true;
            }
            
        }

    }

    function validateDate(text) {

        if (text == '' || text == null) {
            alert('Arival date is required')
            return false;
        } else {
            return true;
        }

    }

    function validateBarcodes(text) {

        if (text == '' || text == null) {
            alert('Valid barcode is required')
            return false;
        } else {
            return true;
        }

    }

    function validateDescription(text, label) {

        if (text == '' || text == null) {
            alert(label + ' is required')
            return false;
        } else {
            if (text.length > 400) {
                alert('description must be less than 400 characters')
                return false
            } else {
                return true;
            }
        }

    }

    function checkInArray(arry_phone, phone) {
        var res = false
        for (let index = 0; index < arry_phone.length; index++) {
            const element = arry_phone[index];

            if (element == phone) {
                res = true
            }

        }
        return res
    }

    /*************************package filtering by staff and destination************/
    $(document).on('click', '#pdf_btn', function () {

        var branch_id = $('#branch_select').val();
        var staff_id = $('#staff_select').val();
        var to_branch_name = $("#branch_select option:selected").text();
        //var tag_id = $('#tag_select').val();

        //alert(branch_id+", "+staff_id)

        $('#loading').attr('class', 'loading-show  d-flex justify-content-center')
        $.ajax({
            url: '/pdf-outgoing-package',
            method: 'POST',
            data: {
                branch_id, staff_id,to_branch_name
            }
        })
            .then((response) => {
                $('#pdfModal').modal('show')
                $('#package_manfest').html(response);
            })
            .catch((error) => {
                $('#loading').attr('class', 'loading-hiden')
                console.log(error)
            });

    })

    $(document).on('click', '#filter_btn', function () {

        var branch_id = $('#branch_select').val();
        var staff_id = $('#staff_select').val();
        //var tag_id = $('#tag_select').val();

        //alert(branch_id+", "+staff_id)

        $('#loading').attr('class', 'loading-show  d-flex justify-content-center')
        $.ajax({
            url: '/filter-outgoing-package',
            method: 'POST',
            data: {
                branch_id, staff_id
            }
        })
            .then((response) => {
                $('#loading').attr('class', 'loading-hiden')
                $('#outgoing-list').html(response);
            })
            .catch((error) => {
                $('#loading').attr('class', 'loading-hiden')
                console.log(error)
            });

    })

    $(document).on('click', '.btn-close', function () {

        window.location.reload();
    })

    $(document).on('click', '.remove_btn', function () {

        var pname = $(this).attr('pname');
        var pimage = $(this).attr('pimage');
        var pbranch = $(this).attr('pbranch');
        var pid = $(this).attr('pid');
        var bid = $(this).attr('bid');

        $('#action-type').val('remove')

        $('#remove-pname').text(pname)
        $('#input-pid').val(pid)
        $('#remove-bname').text(pbranch)
        $('#remove-img').attr('src', '/images/' + pimage)

        $('#removeModal').modal('show')
    })

    $(document).on('click', '#search-bar', function (e) {

        e.preventDefault()
        var input_code = $('#input-code').val();
        var pid = $('#input-pid').val();

        $('#reading-bar').attr('class', 'scanner-area loading-hiden')
        $('#loading-bar').attr('class', 'loading-show')

        $.ajax({
            url: '/find-onuse-barcode-remove',
            method: 'POST',
            data: {
                input_code, pid
            }
        })
            .then((response) => {

                $('#loading-bar').attr('class', 'loading-hiden')
                $('#reading-bar').attr('class', 'scanner-area')

                if (response.status == 1) {
                    $('#barcode-msg').html("<h4 class='text-success'>Barcode is valid</h4>");
                    $('#code-text').val(response.code_text)
                    $('#codebar-img').attr('src', response.code_data)

                } else if (response.status == 2) {
                    $('#code-text').val('')
                    $('#barcode-msg').html("<h4 class='text-danger'>Barcode is not onuse or branch not match</h4>");

                }
                else {
                    $('#code-text').val('')
                    $('#barcode-msg').html("<h4 class='text-danger'>Barcode is invalid</h4>");
                }

            })
            .catch((error) => {
                console.log(error)
                alert('Check internet, try again')
            });

    })

    $(document).on('click', '#remove-package', function (e) {
        e.preventDefault()
        try {

            var barcode_id = $('#code-text').val()
            var description = $('#description').val()
            var pid = $('#input-pid').val();

            if (validateBarcodes(barcode_id) && validateDescription(description, 'Description')) {

                if (confirm('Are you sure you want to remove this package ?')) {

                    $('#loading').attr('class', 'loading-show')


                    $.ajax({
                        url: '/remove-package',
                        method: 'POST',
                        data: {
                            barcode_id, pid, description
                        }
                    })
                        .then((response) => {

                            $('#loading').attr('class', 'loading-hiden')

                            if (response.status == "good") {
                                alert(response.msg)
                                $('#code-text').val('')
                                $('#description').val('')
                                $('#removeModal').modal('hide')
                                document.getElementById('package_' + pid).remove()
                            } else {
                                alert(response.msg)
                            }

                        })
                        .catch((error) => {
                            console.log(error)
                            alert('Check internet, try again')
                        });

                }
            }

        } catch (error) {
            console.log(error)
            alert('something is wrong')
        }

    })

    ///////messages function/////////////////////////////////////////////////////////
        $(document).on('click', '#send_sms', function () {
        var phone_list = $('#phone_list').val();
        var message = $('#message_field').val();

        if(validateNames(phone_list, 'Phone Number or List, separated by comma') && validateMessage(message, 'Message')){

           $('#loading-send-sms').attr('class', 'loading-show  d-flex justify-content-center')
           $('#send_sms').attr('disabled', true)
           $('#clear_chat').attr('disabled', true)

           $.ajax({
            url: '/send-multi-sms',
            method: 'POST',
            data: {
                phone_list, message
            }
        })
            .then((response) => {
                $('#loading-send-sms').attr('class', 'loading-hiden')
                 $('#send_sms').removeAttr('disabled')
                 $('#clear_chat').removeAttr('disabled')

                if(response.status == 'good'){
                    alert(response.msg)
                    $('#phone_list').val("");
                    $('#message_field').val("");
                    $('#message_phone').attr('class', 'loading-hiden')
                }else{
                    alert(response.msg)
                }
            })
            .catch((error) => {
                $('#loading-send-sms').attr('class', 'loading-hiden')
                console.log(error)
            });
        }

       
        //$('#phone_list').text("");
        //$('#message_field').text("");
        //$('#message_phone').attr('class', 'loading-hiden')
    })
    $(document).on('click', '#clear_chat', function () {
        $('#phone_list').val("");
        $('#message_field').val("");
        $('#message_phone').attr('class', 'loading-hiden')
    })

    $(document).on('click', '.add_phone', function () {

        $('#message_phone').attr('class', 'loading-show')
        var phone = $(this).attr('phone');

        var str_phone = $('#phone_list').val();

        if (str_phone == "" || str_phone == undefined) {
            $('#phone_list').text(phone + ",");

        } else {
            var arry_phone = str_phone.split(',')
            //alert(arry_phone.length)
            if (checkInArray(arry_phone, phone)) {
                if (confirm(phone+' aleady exist, do you want to remove it?')) {
                    const index = arry_phone.indexOf(phone);
                    if (index > -1) { 
                    arry_phone.splice(index, 1);
                    $('#phone_list').text(arry_phone.toString());
                    }
                    
                }
            } else {
                $('#phone_list').text(str_phone + phone + ",");
            }
        }

    })


    $(document).on('click', '#sms_btn', function () {
        
         var branch_id = $('#branch_select').val();
        var staff_id = $('#staff_select').val();

        $('#message_phone').attr('class', 'loading-show')
        //var tag_id = $('#tag_select').val();

        //alert(branch_id+", "+staff_id)

        $('#loading').attr('class', 'loading-show  d-flex justify-content-center')
        $.ajax({
            url: '/filter-receiver-phones',
            method: 'POST',
            data: {
                branch_id, staff_id
            }
        })
            .then((response) => {
                $('#loading').attr('class', 'loading-hiden')
                if(response.status == 'good'){
                    $('#phone_list').text(response.phone_list);
                    $('#message_field').val("");
                    $('#message_phone').attr('class', 'loading-show')
                }else{
                    alert(response.msg)
                }
            })
            .catch((error) => {
                $('#loading').attr('class', 'loading-hiden')
                console.log(error)
            });
    })
    /*-------------------------edit function going here-----------------------*/

    $(document).on('click', '.edit_btn', function () {

        var pname = $(this).attr('pname');
        var pimage = $(this).attr('pimage');
        var pbranch = $(this).attr('pbranch');
        var pid = $(this).attr('pid');
        var bid = $(this).attr('bid');

        $('#action-type').val('update')

        $('#edit-pname').text(pname)
        $('#input-pid-edit').val(pid)
        $('#edit-bname').text(pbranch)
        $('#edit-img').attr('src', '/images/' + pimage)

        $('#editModal').modal('show')
    })


    $(document).on('click', '#search-bar-edit', function (e) {

        e.preventDefault()
        var input_code = $('#input-code-edit').val();
        var pid = $('#input-pid-edit').val();

        $('#reading-bar-edit').attr('class', 'scanner-area loading-hiden')
        $('#loading-bar-edit').attr('class', 'loading-show')

        $.ajax({
            url: '/find-onuse-barcode-edit',
            method: 'POST',
            data: {
                input_code, pid
            }
        })
            .then((response) => {

                $('#loading-bar-edit').attr('class', 'loading-hiden')
                $('#reading-bar-edit').attr('class', 'scanner-area')

                if (response.status == 1) {
                    var date = response.data.arive_at
                    date = date.split('T')

                    $('#barcode-msg-edit').html("<h4 class='text-success'>Barcode is valid</h4>");
                    $('#code-text-edit').val(response.code_text)
                    $('#codebar-img-edit').attr('src', response.code_data)
                    $('#p_edit_id').val(response.data.id)

                    $('#sender_name').val(response.data.sender_name);
                    $('#sender_phone').val(response.data.sender_phone);
                    $('#receiver_name').val(response.data.receiver_name);
                    $('#receiver_phone').val(response.data.receiver_phone);
                    $('#transporter_name').val(response.data.transporter_name);
                    $('#transporter_phone').val(response.data.transporter_phone);
                    $('#name').val(response.data.name)
                    $('#price').val(parseInt(response.data.price))
                    $('#branch_to').val(response.data.branch_to)
                    $('#arive_at').val(date[0])
                    $('#description-edit').val(response.data.description)
                    console.log(response.data)

                    $('#package-form').attr('class', 'col-12 loading-show')

                } else if (response.status == 2) {
                    $('#code-text-edit').val('')
                    $('#barcode-msg-edit').html("<h4 class='text-danger'>Barcode is not onuse or branch not match</h4>");

                    $('#package-form').attr('class', 'loading-hiden')
                }
                else {
                    $('#code-text-edit').val('')
                    $('#barcode-msg-edit').html("<h4 class='text-danger'>Barcode is invalid</h4>");
                    $('#package-form').attr('class', 'loading-hiden')
                }

            })
            .catch((error) => {
                console.log(error)
                alert('Check internet, try again')
            });

    })

    $(document).on('click', '#update-package', function (e) {
        e.preventDefault()
        try {

            var sender_name = $('#sender_name').val();
            var sender_phone = $('#sender_phone').val();
            var receiver_name = $('#receiver_name').val();
            var receiver_phone = $('#receiver_phone').val();
            var transporter_name = $('#transporter_name').val();
            var transporter_phone = $('#transporter_phone').val();
            var barcode_id = $('#code-text-edit').val()
            var pid = $('#p_edit_id').val()
            var name = $('#name').val()
            var price = $('#price').val()
            var branch_to = $('#branch_to').val()
            var arive_at = $('#arive_at').val()
            var description = $('#description-edit').val()
            var _description = $('#description-edit-reason').val()



            if (validateDescription(_description, 'Reason to edit a package') && validateNames(sender_name, 'Sender') && validatePhone(sender_phone, 'Sender') && validateNames(receiver_name, 'Receiver') && validatePhone(receiver_phone, 'Receiver') && validateNames(transporter_name, 'Transporter') && validatePhone(transporter_phone, 'Transporter') && validateBarcodes(barcode_id) && validateNames(name, 'Package') && validateAmount(price) && validateDate(arive_at)) {

                if (confirm('Are you sure you want to send this package ?')) {

                    $('#loading-update').attr('class', 'loading-show')
                    $('#update-package').attr('disabled', true)

                    var edit_description = 'Reason to edit: ' + _description

                    $.ajax({
                        url: '/update-package',
                        method: 'POST',
                        data: {
                            barcode_id, edit_description, name, arive_at, branch_to, price, pid, sender_name, sender_phone, receiver_name, receiver_phone, transporter_name, transporter_phone
                        }
                    })
                        .then((response) => {

                            $('#loading-update').attr('class', 'loading-hiden')
                            $('#update-package').removeAttr('disabled')

                            if (response.status == 'good') {
                                alert(response.msg)
                                window.location.reload();
                            } else {
                                alert(response.msg)
                            }

                        })
                        .catch((error) => {
                            console.log(error)
                            alert('Check internet, try again')
                        });

                }
            }

        } catch (error) {
            console.log(error)
            alert('something is wrong')
        }

    })

///////////print
 $(document).on('click', '#print_pdf', function () {
        alert('Richard')
        printJS({
            printable: 'package_manfest',
            type: 'html',
            targetStyle: ['*'],
            //style: `@import url('https://fonts.googleapis.com/css?family=Annie+Use+Your+Telescope');`,
            // font: 'Annie Use Your Telescope'
            //header: 'Hello am printing', tahoma
            style: `#package_manfes{width:90%}.pdf-item{border: 1px solid #555;border-radius: 8px;padding: 15px 10px; margin-bottom: 20px;}.pdf-table {width: 100%;}.td-1 {width: 40%;padding-left:8px;}.td-2 {width: 30%; padding-left:8px;} @page { margin: 30px 10px; size: 80m 80m; } @media print { body { margin: 2mm; width: 96%; height:auto;font_size:20px } }`,
            //font:'tahoma'
        })

        /*.pdf-item{border: 1px solid #555;border-radius: 8px;padding: 15px 10px; margin-bottom: 20px;}
    .pdf-table {width: 100%;}
.td-1 {width: 40%;padding-left:8px;}
.td-2 {width: 30%; padding-left:8px;}
*/

    })
    /*
        document.addEventListener('keypress', e => {
            //usually scanners throw an 'Enter' key at the end of read
            //e.preventDefault()
    
            if (e.keyCode === 13) {
                if (code.length >= 12) {
                    //console.log(code);
                    var action_type = $('#action-type').val();
    
                    if (action_type == 'update') {
    
                        //var input_code = $('#input-code-edit').val();
                        var pid = $('#input-pid-edit').val();
    
                        $('#reading-bar-edit').attr('class', 'scanner-area loading-hiden')
                        $('#loading-bar-edit').attr('class', 'loading-show')
    
                        $.ajax({
                            url: '/find-onuse-barcode-edit',
                            method: 'POST',
                            data: {
                                input_code: code, pid
                            }
                        })
                            .then((response) => {
    
                                $('#loading-bar-edit').attr('class', 'loading-hiden')
                                $('#reading-bar-edit').attr('class', 'scanner-area')
    
                                if (response.status == 1) {
                                    var date = response.data.arive_at
                                    date = date.split('T')
    
                                    $('#barcode-msg-edit').html("<h4 class='text-success'>Barcode is valid</h4>");
                                    $('#code-text-edit').val(response.code_text)
                                    $('#codebar-img-edit').attr('src', response.code_data)
                                    $('#p_edit_id').val(response.data.id)
    
                                    $('#sender_name').val(response.data.sender_name);
                                    $('#sender_phone').val(response.data.sender_phone);
                                    $('#receiver_name').val(response.data.receiver_name);
                                    $('#receiver_phone').val(response.data.receiver_phone);
                                    $('#transporter_name').val(response.data.transporter_name);
                                    $('#transporter_phone').val(response.data.transporter_phone);
                                    $('#name').val(response.data.name)
                                    $('#price').val(parseInt(response.data.price))
                                    $('#branch_to').val(response.data.branch_to)
                                    $('#arive_at').val(date[0])
                                    $('#description-edit').val(response.data.description)
                                    console.log(response.data)
    
                                    $('#package-form').attr('class', 'col-12 loading-show')
    
                                } else if (response.status == 2) {
                                    $('#code-text-edit').val('')
                                    $('#barcode-msg-edit').html("<h4 class='text-danger'>Barcode doen't match with Package or Branch</h4>");
    
                                    $('#package-form').attr('class', 'loading-hiden')
                                } else if (response.status == 3) {
                                    $('#code-text').val('')
                                    $('#barcode-msg-receive').html("<h4 class='text-danger'>Barcode doesn't match with action</h4>");
    
                                }
                                else {
                                    $('#code-text-edit').val('')
                                    $('#barcode-msg-edit').html("<h4 class='text-danger'>Barcode is invalid</h4>");
                                    $('#package-form').attr('class', 'loading-hiden')
                                }
    
                            })
                            .catch((error) => {
                                console.log(error)
                                alert('Check internet, try again')
                            });
    
                    } else if (action_type == 'remove') {
    
                        //var input_code = $('#input-code').val();
                        var pid = $('#input-pid').val();
    
                        $('#reading-bar').attr('class', 'scanner-area loading-hiden')
                        $('#loading-bar').attr('class', 'loading-show')
    
                        $.ajax({
                            url: '/find-onuse-barcode-remove',
                            method: 'POST',
                            data: {
                                input_code: code, pid
                            }
                        })
                            .then((response) => {
    
                                $('#loading-bar').attr('class', 'loading-hiden')
                                $('#reading-bar').attr('class', 'scanner-area')
    
                                if (response.status == 1) {
                                    $('#barcode-msg').html("<h4 class='text-success'>Barcode is valid</h4>");
                                    $('#code-text').val(response.code_text)
                                    $('#codebar-img').attr('src', response.code_data)
    
                                } else if (response.status == 2) {
                                    $('#code-text').val('')
                                    $('#barcode-msg').html("<h4 class='text-danger'>Barcode or Branches not match the Package</h4>");
    
                                 } else if (response.status == 3) {
                                    $('#code-text').val('')
                                    $('#barcode-msg').html("<h4 class='text-danger'>Barcode doesn't match with action</h4>");
    
                                }
                                else {
                                    $('#code-text').val('')
                                    $('#barcode-msg').html("<h4 class='text-danger'>Barcode is invalid</h4>");
                                }
    
                            })
                            .catch((error) => {
                                console.log(error)
                                alert('Check internet, try again')
                            });
    
    
                    } else {
                        alert('Click action button or Refresh page and try again')
                    }
    
                    code = "";
                }
            } else {
                $('#barcode-msg').html("<h4 class='text-danger'>Something wrong</h4>");
                code += e.key; //while this is not an 'enter' it stores the every key            
            }
    
            //run a timeout of 200ms at the first read and clear everything
            if (!reading) {
                reading = true;
                setTimeout(() => {
                    code = "";
                    reading = false;
                }, 200);  //200 works fine for me but you can adjust it
            }
        });*/

</script>